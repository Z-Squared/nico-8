pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
--[[ init
nico-8
by nodocchi

nico nico nii♥
--]]

function _init()
	t=0
	palt(0,false)
	
	nico = { -- nico-nii
	 x = 0,
	 y = 60,
	 vx = 0,
	 vy = 0,
	 s = 1,
	 l = false -- left?
	}
end

-->8
-- update + related

function _update()
	t=t+1
	if t == 32766 then	t = 0	end -- lolololololol

 if stat(16) != 1 then
  handle_input()
 else
  nico.s = 4
 end

 brake()

	if nico.vx > 5 then nico.vx = 5 end
 if nico.vx < -5 then nico.vx = -5 end

 nico.x = nico.x + nico.vx
 nico.y = nico.y + nico.vy
 
 if nico.y > 60 then
  nico.vy = 0
  nico.y = 60
 end

end

function handle_input()
 nico.s = 1

	-- nico nico nii♥
 if (btn(2)) and on_ground() then
 	if nico.vx == 0 then
 		if stat(16) != 1 then
 		 sfx(1, 0)
 		end	
 	else
 		brake()
 	end
 	
 	return
 end
 
	-- jump
	if nico.jumping and not (btn(4)) and on_ground() then
	 nico.jumping = false
	end 
 if not nico.jumping and (btn(4)) and on_ground() then
  nico.vy = -8
  nico.jumping = true
  sfx(0)
 end
 
 -- jump acceleration
	if nico.y < 60 then
	 if btn(4) then
	  nico.vy = nico.vy + 1
	 else
	  nico.vy = nico.vy + 2
	 end
	end
 
 -- both directions means no movement
 if (btn(0) and btn(1)) then
 	return
 end
 
 -- directions
 if (btn(0)) then 
 	nico.vx=nico.vx-2
 	nico.l=true
 	nico.s=2+t/4%2
 end
	if (btn(1)) then 
		nico.vx=nico.vx+2 
		nico.l=false
		nico.s=2+t/4%2
	end
	
end

function brake()
	if nico.vx > 0 then nico.vx = nico.vx - 1 end
 if nico.vx < 0 then nico.vx = nico.vx + 1 end
end

function on_ground()
	return nico.y == 60
end
-->8
-- draw + related

function _draw()
	cls()
	
	print(stat(16) ,0,0,7)
	
	local left = nico.l
	
	rectfill(10,10,118,118,13)
  
	palt(11,false)
 map(0,0, 0,0, 20,20)
	palt(11,true)

 if nico.s == 4 then
 	nico.l = false
  if t%16 > 8 then
   print("nico nico nii♥",nico.x-20,nico.y-8,14)
  end
 end 

 if nico.jumping and not on_ground() then
 	if nico.vy > 0 then
 	 nico.s = 6
 	else
 	 nico.s = 5
 	end
 end

 drawsprite(nico)
 nico.l = left
end

function drawsprite(s) -- this is cool
	spr(s.s, s.x, s.y, 1, 1, s.l)
end

__gfx__
00000000bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb80000bbb00b0bbb000000000000000000000000000000000000000000000000000000000000000000000000
00000000b80000bbb80000bbb80000bbb80008bb0800f00bb80000bb000000000000000000000000000000000000000000000000000000000000000000000000
007007000800f00b0800f00b0800f00b8000f08b00f2f20b0800f00b000000000000000000000000000000000000000000000000000000000000000000000000
0007700000f2f20b00f2f20b00f2f20b072f270b00ffff0b00f2f00b000000000000000000000000000000000000000000000000000000000000000000000000
0007700000ffff0b00ffff0b00ffff0b0efffe0bb0eeebbbb0ffffbb000000000000000000000000000000000000000000000000000000000000000000000000
00700700b0eeebbbb0eeebbbb0eee7bbb0eeebbbb7ccc7bbb7eee7bb000000000000000000000000000000000000000000000000000000000000000000000000
00000000b7ccc7bbb7ccc1bbb1cccbbbbbcccbbbb1b1bbbbbbcccbbb000000000000000000000000000000000000000000000000000000000000000000000000
00000000bb1b1bbbbb1bbbbbbbbb1bbbbb1b1bbbbbbbbbbbbb1bb1bb000000000000000000000000000000000000000000000000000000000000000000000000
3333b3b3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
b33b3333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44454444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44544454000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
54545454000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44445444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44554455000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
54444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44454554000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
45444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
45544454000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444544000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
45444544000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44454445000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44544444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100000d57023570305703d5503f5203a300380002b00032000350003700038000390003a0003a0003a00039000390003700031000280001d00017000100000c000080000600003000020003c0003c0003c000
01110000287701d73009700287701d730097002a7502a7402a7400970001700016000250002500025000150001500015000000000000000000000000000000000000000000000000000000000000000000000000
00100000030000100003000030000a0000a0000800001000010000a000000000a0000a0000a000010000300003000080000a0000a0000a000080000800001000030000a00008000030000a000000000000000000
__music__
00 02424344

